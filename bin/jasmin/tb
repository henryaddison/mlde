#!/usr/bin/bash
# run tensorboard on a login node on a random port

set -euo pipefail

runs_dir=$1
host=${2:-sci-vm-03.jasmin}

port=$(shuf -i 6000-9999 -n 1)
echo "Using port ${port} on ${host}"

ssh -t -L ${port}:localhost:${port} ${host} "pixi run --manifest-path /home/users/vf20964/code/mlde tensorboard --port=${port} --logdir=${runs_dir}"
